[
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": "\n    @page {\n        size: A4 landscape; /* Change from portrait to landscape */\n        margin: 10mm; /* Adjust margins if needed */\n    }\n",
  "custom_format": 1,
  "default_print_language": null,
  "disabled": 0,
  "doc_type": "Sales Invoice",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": "[{\"fieldname\": \"print_heading_template\", \"fieldtype\": \"Custom HTML\", \"options\": \"<div class=\\\"print-heading\\\">\\t\\t\\t\\t<h2><div>Sales Invoice</div><br><small class=\\\"sub-heading\\\">{{ _(doc.name) }}</small>\\t\\t\\t\\t</h2></div>\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"customer_name\", \"print_hide\": 0, \"label\": \"Customer Name\"}, {\"fieldname\": \"tax_id\", \"print_hide\": 0, \"label\": \"Tax Id\"}, {\"fieldname\": \"company_tax_id\", \"print_hide\": 0, \"label\": \"Company Tax ID\"}, {\"fieldname\": \"custom_item_classification_code_\", \"print_hide\": 0, \"label\": \"Item Classification Code \"}, {\"fieldname\": \"custom_einvoice\", \"print_hide\": 0, \"label\": \"e-Invoice\"}, {\"fieldname\": \"is_consolidated\", \"print_hide\": 0, \"label\": \"Is Consolidated\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"posting_date\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Date\"}, {\"fieldname\": \"custom_payment_mode\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Payment Mode of invoice\"}, {\"fieldname\": \"due_date\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Payment Due Date\"}, {\"fieldname\": \"custom_zatca_tax_category\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Tax Category\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"items\", \"print_hide\": 0, \"label\": \"Items\", \"visible_columns\": [{\"fieldname\": \"custom_item_classification_code\", \"print_width\": \"25px\", \"print_hide\": 0}, {\"fieldname\": \"description\", \"print_width\": \"200px\", \"print_hide\": 0}, {\"fieldname\": \"qty\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rate\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"discount_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"item_tax_rate\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"net_amount\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"total_qty\", \"print_hide\": 0, \"label\": \"Total Quantity\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"custom_zatca_tax_category\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Tax Category\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"tax_category\", \"print_hide\": 0, \"label\": \"Tax Category\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"total\", \"print_hide\": 0, \"label\": \"Total\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Taxes and Charges\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"incoterm\", \"print_hide\": 0, \"label\": \"Incoterm\"}, {\"fieldname\": \"named_place\", \"print_hide\": 0, \"label\": \"Named Place\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"taxes\", \"print_hide\": 0, \"label\": \"Sales Taxes and Charges\", \"visible_columns\": [{\"fieldname\": \"charge_type\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"row_id\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"account_head\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"description\", \"print_width\": \"300px\", \"print_hide\": 0}, {\"fieldname\": \"included_in_paid_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"cost_center\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rate\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"account_currency\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"tax_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"total\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"tax_amount_after_discount_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"base_tax_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"base_total\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"base_tax_amount_after_discount_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"item_wise_tax_detail\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldtype\": \"Section Break\", \"label\": \"Totals\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"grand_total\", \"print_hide\": 0, \"label\": \"Grand Total\"}, {\"fieldname\": \"use_company_roundoff_cost_center\", \"print_hide\": 0, \"label\": \"Use Company default Cost Center for Round off\"}, {\"fieldname\": \"rounded_total\", \"print_hide\": 0, \"label\": \"Rounded Total\"}, {\"fieldname\": \"in_words\", \"print_hide\": 0, \"label\": \"In Words\"}, {\"fieldname\": \"disable_rounded_total\", \"print_hide\": 0, \"label\": \"Disable Rounded Total\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Additional Discount\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"is_cash_or_non_trade_discount\", \"print_hide\": 0, \"label\": \"Is Cash or Non Trade Discount\"}, {\"fieldname\": \"additional_discount_account\", \"print_hide\": 0, \"label\": \"Discount Account\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Pricing Rules\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"pricing_rules\", \"print_hide\": 0, \"label\": \"Pricing Rule Detail\", \"visible_columns\": [{\"fieldname\": \"pricing_rule\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"item_code\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"margin_type\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rate_or_discount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rule_applied\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldtype\": \"Section Break\", \"label\": \"Billing Address\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"address_display\", \"print_hide\": 0, \"label\": \"Address\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"contact_display\", \"print_hide\": 0, \"label\": \"Contact\"}, {\"fieldname\": \"contact_mobile\", \"print_hide\": 0, \"label\": \"Mobile No\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Shipping Address\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"dispatch_address\", \"print_hide\": 0, \"label\": \"Dispatch Address\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Terms and Conditions\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"terms\", \"print_hide\": 0, \"label\": \"Terms and Conditions Details\"}]",
  "html": "<center>\n    <h3>Sales Invoice</h3>\n    {% if doc.customer_name %}\n        {{ doc.customer_name }}<br>\n    {% endif %}\n    {% if doc.customer_address %}\n        {{ doc.customer_address }}<br>\n    {% endif %}\n    {% if doc.contact_mobile %}\n        {{ doc.contact_mobile }}<br>\n    {% endif %}\n    {% if doc.contact_email %}\n        {{ doc.contact_email }}<br>\n    {% endif %}\n\n</center>\n\n{% set supplier = frappe.get_doc(\"Company\", doc.supplier) %}\n{% set buyer = frappe.get_doc(\"Customer\", doc.customer) %}\n{% set category_map = {'Malaysian': 'E100000000010', 'Non-Malaysian': 'E100000000030', 'Government': 'E100000000040'} %}\n{% set category_ic_map = {'Malaysian': '000000000000', 'Non-Malaysian': buyer.custom_customer_registrationicpassport_number, 'Government': '000000000000'} %}\n\n{% set buyer_tin = category_map.get(buyer.custom_customer_category, 'MappingError') %}\n{% set buyer_ic = category_ic_map.get(buyer.custom_customer_category, 'MappingError') %}\n\n\n<div style=\"display: grid; grid-template-columns: 1fr 1fr; width: 100%;\">\n    <div class=\"text-left\"><strong>Supplier TIN:</strong> {{ supplier.tax_id }}</div>\n    <div class=\"text-right\"><strong>E-Invoice</strong></div>\n\n    <div class=\"text-left\"><strong>Supplier Registration Number:</strong> {{ supplier.custom_company__registrationicpassport_number }}</div>\n    <div class=\"text-right\"><strong>Document Code:</strong> INV{{ doc.name[-4:] or \" \" }}</div>\n\n    <div class=\"text-left\"><strong>Supplier SST ID:</strong> {{ supplier.custom_sst_number }}</div>\n    <div class=\"text-right\"><strong>Unique Identifier No.:</strong> {{ doc.name or \"N/A\" }}</div>\n\n    <div class=\"text-left\"><strong>Supplier MSIC Code:</strong> {{ supplier.custom_msic_code_.split(':')[0] }}</div>\n    <div class=\"text-right\"><strong>Original Invoice Ref. No:</strong> Not Applicable</div>\n    <div class=\"text-left\"></div>\n    <div class=\"text-right\"><strong>Invoice Date & Time:</strong> {{ doc.posting_date }} {{ doc.posting_time or \"\" }}</div>\n</div>\n\n<hr style=\"border: 0; height: 1px; background: #ccc; margin: 10px 0;\">\n\n<div style=\"display: grid; grid-template-columns: 1fr 1fr; width: 100%;\">\n    <div class=\"text-left\"><strong>Buyer TIN:</strong> {{ buyer_tin }}</div> \n    <div class=\"text-right\"><strong>Payment mode: </strong>{{ doc.custom_payment_mode }}</div>\n\n    <div class=\"text-left\"><strong>Buyer Name:</strong> {{ buyer.name }}</div>\n    <div class=\"text-right\"><strong>Frequency of billing:</strong> {{ doc.frequency or \"NA\" }}</div>\n\n    <div class=\"text-left\"><strong>Buyer Identification Number:</strong> {{ buyer_ic }}</div>\n    <div class=\"text-right\"><strong>Billing period.:</strong> {{ doc.billing_period or \"NA\" }}</div>\n\n    <div class=\"text-left\"><strong>Buyer Address:</strong> {{ buyer.primary_address }}</div>\n    <div class=\"text-right\"><strong>Invoice currency code:</strong> {{ doc.currency }}</div>\n    \n    <!--<div class=\"text-left\"><strong>Buyer Contact Number (Mobile):</strong> {{ buyer.mobile_no or '' }}</div>-->\n    <!--<div class=\"text-right\"></div>-->\n    <!--<div class=\"text-left\"><strong>Buyer Email:</strong> {{ buyer.email_id or '' }}</div>-->\n    <!--<div class=\"text-right\"></div>-->\n    <!--<div class=\"text-left\"><strong>Buyer SST Registration ID:</strong> NA</div>-->\n</div>\n\n\n\n<table class=\"table table-bordered\">\n\t<thead style=\"background-color: black; color: white;\">\n\t\t<tr>\n\t\t\t<th class=\"text-center\"><strong>Classification</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Description</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Quantity</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Unit Price</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Amount</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Disc</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Amount</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Total Product / Service Price (incl. tax)</strong></th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t{% for item in doc.items %}\n\t\t<tr>\n\t\t\t<td>{{ item.custom_item_classification_code }}</td>\n\t\t\t<td>{{ item.description or \"\" }}</td> \n\t\t\t<td class=\"text-right\">{{ item.qty }}</td>\n\t\t\t<td class=\"text-right\">{{ item.rate }}</td>\n\t\t\t<td class=\"text-right\">{{ item.amount }}</td>\n\t\t\t<td class=\"text-right\">{{ item.discount_amount or '-' }}</td>  \n\t\t\t<td class=\"text-right\">{{ item.amount*doc.taxes[0].rate/100 }}</td>\n\t\t\t<td class=\"text-right\">\n\t\t\t\t{{ (item.amount|float - (item.discount_amount|float or 0)) + (item.item_tax_rate|float or 0) }}\n\t\t\t</td>\n\t\t</tr>\n\t\t{% endfor %}\n\t\t\t<!-- Subtotal, Tax, and Grand Total -->\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Subtotal</strong></td>\n\t\t\t<td class=\"text-right\">{{ doc.total }}</td>  <!-- Assuming doc.total exists -->\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.total_taxes_and_charges or 0 }}</td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Total excluding tax</strong></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total - doc.total_taxes_and_charges or 0 }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Tax amount</strong></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.total_taxes_and_charges or 0 }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Total including tax</strong></td>\n\t\t\t<td></td></td> \n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Paid by - {{ doc.custom_payment_mode }}</strong></td>\n\t\t\t<td></td></td> \n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total }}</td>\n\t\t</tr>\n\t\t\n\t</tbody>\n</table>\n\n\n<table class=\"table table-bordered\" style=\"width:60%;\">\n\t<thead style=\"background-color: black; color: white;\">\n\t\t<tr>\n\t\t\t<th class=\"text-center\"><strong>Total Product / Service Price</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Type</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Rate</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Amount</strong></th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t<tr>\n\t\t    <!-- Total Price after Discount -->\n\t\t    <td class=\"text-right\">\n\t\t        {{ doc.total }}\n\t\t    </td>\n\t\t    \n\t\t    <!-- Tax Type (Fetch from item.tax_code or use default text) -->\n\t\t    <td class=\"text-right\">{{ doc.taxes[0].description }}</td> \n\t\t    \n\t\t    <!-- Tax Rate (Assuming item.item_tax_rate is already in percentage) -->\n\t\t    <td class=\"text-right\">{{ doc.taxes[0].rate }}%</td> \n\n\t\t    <!-- Tax Amount Calculation -->\n\t\t    <td class=\"text-right\">\n\t\t        {{ doc.total_taxes_and_charges or 0 }}\n\t\t    </td>\n\t\t</tr>\n\t\t\n\t</tbody>\n</table>\n\n{% set now = frappe.utils.now_datetime() %}\n<div style=\"display: grid; grid-template-columns: 1fr 1fr; width: 100%; align-items: start;\">\n    <!-- Left Column -->\n    <div>\n        <div class=\"text-left\"><strong>Digital Signature:</strong></div> \n        <div class=\"text-left\">{{ doc.digital_signature or \"N/A\" }}</div> \n        \n        <!-- Is this also current date and time? or when the item was submitted? -->\n        <div class=\"text-left\"><strong>Date and Time of Validation:</strong> {{ doc.validation_time or \"N/A\" }}</div> \n        <div class=\"text-left\" style=\"color: red;\">current or doc's validation time? {{ now.strftime(\"%d/%m/%Y %H:%M:%S\") }}</div> \n        \n        <div class=\"text-left\">This document is a visual presentation of the e-Invoice</div>\n    </div>\n\n    <!-- Right Column (QR Code) -->\n    <div class=\"text-right\">\n        <img src=\"https://rlv.zcache.com/customizable_qr_code_square_sticker-r0844cd7638e642adabc1a19b0bbbf715_0ugmc_8byvr_80.webp\" \n             alt=\"QR Code\" style=\"max-width: 120px; height: auto;\">\n    </div>\n</div>\n\nDEBUG:\n<pre>\n    {{ buyer.as_dict() | pprint }}\n</pre>\n",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-04-14 01:10:05.494037",
  "module": "Myinvois Erpgulf",
  "name": "SalesInvoiceSelfBilled",
  "page_number": "Hide",
  "print_format_builder": 1,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 },
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": "\n    @page {\n        size: A4 landscape; /* Change from portrait to landscape */\n        margin: 10mm; /* Adjust margins if needed */\n    }\n",
  "custom_format": 1,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "Sales Invoice",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": "[{\"fieldname\": \"print_heading_template\", \"fieldtype\": \"Custom HTML\", \"options\": \"<div class=\\\"print-heading\\\">\\t\\t\\t\\t<h2><div>Sales Invoice</div><br><small class=\\\"sub-heading\\\">{{ _(doc.name) }}</small>\\t\\t\\t\\t</h2></div>\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"customer_name\", \"print_hide\": 0, \"label\": \"Customer Name\"}, {\"fieldname\": \"tax_id\", \"print_hide\": 0, \"label\": \"Tax Id\"}, {\"fieldname\": \"company_tax_id\", \"print_hide\": 0, \"label\": \"Company Tax ID\"}, {\"fieldname\": \"custom_item_classification_code_\", \"print_hide\": 0, \"label\": \"Item Classification Code \"}, {\"fieldname\": \"custom_einvoice\", \"print_hide\": 0, \"label\": \"e-Invoice\"}, {\"fieldname\": \"is_consolidated\", \"print_hide\": 0, \"label\": \"Is Consolidated\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"posting_date\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Date\"}, {\"fieldname\": \"custom_payment_mode\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Payment Mode of invoice\"}, {\"fieldname\": \"due_date\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Payment Due Date\"}, {\"fieldname\": \"custom_zatca_tax_category\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Tax Category\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"items\", \"print_hide\": 0, \"label\": \"Items\", \"visible_columns\": [{\"fieldname\": \"custom_item_classification_code\", \"print_width\": \"25px\", \"print_hide\": 0}, {\"fieldname\": \"description\", \"print_width\": \"200px\", \"print_hide\": 0}, {\"fieldname\": \"qty\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rate\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"discount_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"item_tax_rate\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"net_amount\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"total_qty\", \"print_hide\": 0, \"label\": \"Total Quantity\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"custom_zatca_tax_category\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Tax Category\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"tax_category\", \"print_hide\": 0, \"label\": \"Tax Category\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"total\", \"print_hide\": 0, \"label\": \"Total\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Taxes and Charges\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"incoterm\", \"print_hide\": 0, \"label\": \"Incoterm\"}, {\"fieldname\": \"named_place\", \"print_hide\": 0, \"label\": \"Named Place\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"taxes\", \"print_hide\": 0, \"label\": \"Sales Taxes and Charges\", \"visible_columns\": [{\"fieldname\": \"charge_type\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"row_id\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"account_head\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"description\", \"print_width\": \"300px\", \"print_hide\": 0}, {\"fieldname\": \"included_in_paid_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"cost_center\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rate\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"account_currency\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"tax_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"total\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"tax_amount_after_discount_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"base_tax_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"base_total\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"base_tax_amount_after_discount_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"item_wise_tax_detail\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldtype\": \"Section Break\", \"label\": \"Totals\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"grand_total\", \"print_hide\": 0, \"label\": \"Grand Total\"}, {\"fieldname\": \"use_company_roundoff_cost_center\", \"print_hide\": 0, \"label\": \"Use Company default Cost Center for Round off\"}, {\"fieldname\": \"rounded_total\", \"print_hide\": 0, \"label\": \"Rounded Total\"}, {\"fieldname\": \"in_words\", \"print_hide\": 0, \"label\": \"In Words\"}, {\"fieldname\": \"disable_rounded_total\", \"print_hide\": 0, \"label\": \"Disable Rounded Total\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Additional Discount\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"is_cash_or_non_trade_discount\", \"print_hide\": 0, \"label\": \"Is Cash or Non Trade Discount\"}, {\"fieldname\": \"additional_discount_account\", \"print_hide\": 0, \"label\": \"Discount Account\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Pricing Rules\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"pricing_rules\", \"print_hide\": 0, \"label\": \"Pricing Rule Detail\", \"visible_columns\": [{\"fieldname\": \"pricing_rule\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"item_code\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"margin_type\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rate_or_discount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rule_applied\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldtype\": \"Section Break\", \"label\": \"Billing Address\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"address_display\", \"print_hide\": 0, \"label\": \"Address\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"contact_display\", \"print_hide\": 0, \"label\": \"Contact\"}, {\"fieldname\": \"contact_mobile\", \"print_hide\": 0, \"label\": \"Mobile No\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Shipping Address\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"dispatch_address\", \"print_hide\": 0, \"label\": \"Dispatch Address\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Terms and Conditions\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"terms\", \"print_hide\": 0, \"label\": \"Terms and Conditions Details\"}]",
  "html": "<center>\n    <h3>Sales Invoice</h3>\n    {{ doc.customer_name }}<br>\n    {{ doc.customer_address }}<br>\n    {{ doc.contact_mobile }}<br>\n    {{ doc.contact_email }}<br>\n</center>\n\n{% set supplier = frappe.get_doc(\"Supplier\", doc.supplier) %}\n{% set buyer = frappe.get_doc(\"Customer\", doc.customer) %}\n\n<div style=\"display: grid; grid-template-columns: 1fr 1fr; width: 100%;\">\n    <div class=\"text-left\"><strong>Supplier TIN:</strong> {{ supplier.tax_id }}</div>\n    <div class=\"text-right\"><strong>E-Invoice</strong></div>\n\n    <div class=\"text-left\"><strong>Supplier Registration Number:</strong> {{ supplier.registration_number }}</div>\n    <div class=\"text-right\"><strong>Document Code:</strong> {{ doc.document_code or \"N/A\" }}</div>\n\n    <div class=\"text-left\"><strong>Supplier SST ID:</strong> {{ supplier.sst_id }}</div>\n    <div class=\"text-right\"><strong>Unique Identifier No.:</strong> {{ doc.unique_identifier or \"N/A\" }}</div>\n\n    <div class=\"text-left\"><strong>Supplier MSIC Code:</strong> {{ supplier.msic_code }}</div>\n    <div class=\"text-right\"><strong>Invoice Date & Time:</strong> {{ doc.posting_date }} {{ doc.posting_time or \"\" }}</div>\n</div>\n\n<hr style=\"border: 0; height: 1px; background: #ccc; margin: 10px 0;\">\n\n<div style=\"display: grid; grid-template-columns: 1fr 1fr; width: 100%;\">\n    <div class=\"text-left\"><strong>Buyer TIN:</strong> E10000000010</div> <!-- Not sure where to get it from -->\n    <div class=\"text-right\"><strong>Payment mode: </strong>{{ doc.custom_payment_mode }}</div>\n\n    <div class=\"text-left\"><strong>Buyer Name:</strong> {{ buyer.name }}</div>\n    <div class=\"text-right\"><strong>Frequency of billing:</strong> {{ doc.frequency or \"N/A\" }}</div>\n\n    <div class=\"text-left\"><strong>Buyer Identification Number:</strong> {{ buyer.tax_id }}</div> <!-- Not sure where to get it from -->\n    <div class=\"text-right\"><strong>Billing period.:</strong> {{ doc.billing_period or \"N/A\" }}</div>\n\n    <div class=\"text-left\"><strong>Buyer Address:</strong> {{ buyer.customer_primary_address }}</div>\n    <div class=\"text-right\"><strong>Invoice currency code:</strong> {{ doc.currency }}</div>\n    \n    <div class=\"text-left\"><strong>Buyer Contact Number (Mobile):</strong> {{ buyer.mobile_no }}</div>\n    <div class=\"text-left\"><strong>Buyer Email:</strong> {{ buyer.email_id }}</div>\n</div>\n\n\n\n<table class=\"table table-bordered\">\n\t<thead style=\"background-color: black; color: white;\">\n\t\t<tr>\n\t\t\t<th class=\"text-center\"><strong>Classification</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Description</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Quantity</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Unit Price</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Amount</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Disc</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Amount</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Total Product / Service Price (incl. tax)</strong></th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t{% for item in doc.items %}\n\t\t<tr>\n\t\t\t<td>{{ item.custom_item_classification_code[:3] }}</td>\n\t\t\t<td>{{ item.description or \"\" }}</td>\n\t\t\t<td class=\"text-right\">{{ item.qty }}</td>\n\t\t\t<td class=\"text-right\">{{ item.rate }}</td>\n\t\t\t<td class=\"text-right\">{{ item.amount }}</td>\n\t\t\t<td class=\"text-right\">{{ item.discount_amount or 0 }}</td>  \n\t\t\t<td class=\"text-right\">{{ item.item_tax_rate or 0 }}</td>\n\t\t\t<td class=\"text-right\">\n\t\t\t\t{{ (item.amount|float - (item.discount_amount|float or 0)) + (item.item_tax_rate|float or 0) }}\n\t\t\t</td>\n\t\t</tr>\n\t\t{% endfor %}\n\t\t\t<!-- Subtotal, Tax, and Grand Total -->\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Subtotal</strong></td>\n\t\t\t<td class=\"text-right\">{{ doc.total }}</td>  <!-- Assuming doc.total exists -->\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.total_taxes_and_charges or 0 }}</td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Total excluding tax</strong></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total - doc.total_taxes_and_charges or 0 }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Tax amount</strong></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.total_taxes_and_charges or 0 }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Total including tax</strong></td>\n\t\t\t<td></td></td> \n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Paid by - {{ doc.custom_payment_mode }}</strong></td>\n\t\t\t<td></td></td> \n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total }}</td>\n\t\t</tr>\n\t</tbody>\n</table>\n\n\n<table class=\"table table-bordered\" style=\"width:60%;\">\n\t<thead style=\"background-color: black; color: white;\">\n\t\t<tr>\n\t\t\t<th class=\"text-center\"><strong>Total Product / Service Price</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Type</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Rate</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Amount</strong></th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t{% for item in doc.items %}\n\t\t<tr>\n\t\t    <!-- Total Price after Discount -->\n\t\t    <td class=\"text-right\">\n\t\t        {{ (item.amount|float - (item.discount_amount|float or 0)) }}\n\t\t    </td>\n\t\t    \n\t\t    <!-- Tax Type (Fetch from item.tax_code or use default text) -->\n\t\t    <td class=\"text-right\">{{ item.tax_code or \"N/A\" }}</td> \n\t\t    \n\t\t    <!-- Tax Rate (Assuming item.item_tax_rate is already in percentage) -->\n\t\t    <td class=\"text-right\">{{ item.item_tax_rate or 0 }}%</td> \n\n\t\t    <!-- Tax Amount Calculation -->\n\t\t    <td class=\"text-right\">\n\t\t        {{ ((item.amount|float - (item.discount_amount|float or 0)) * (item.item_tax_rate|float or 0) / 100) }}\n\t\t    </td>\n\t\t</tr>\n\t\t{% endfor %}\n\t</tbody>\n</table>\n\n{% set now = frappe.utils.now_datetime() %}\n\n<div style=\"display: grid; grid-template-columns: 1fr 1fr; width: 100%; align-items: start;\">\n    <!-- Left Column -->\n    <div>\n        <div class=\"text-left\"><strong>Digital Signature:</strong></div> \n        <div class=\"text-left\">{{ doc.digital_signature or \"N/A\" }}</div> \n        <div class=\"text-left\"><strong>Date and Time of Validation:</strong> {{ now.strftime(\"%d/%m/%Y %H:%M:%S\") }}</div> \n        <div class=\"text-left\">This document is a visual presentation of the e-Invoice</div>\n    </div>\n\n    <!-- Right Column (QR Code) -->\n    <div class=\"text-right\">\n        <img src=\"https://rlv.zcache.com/customizable_qr_code_square_sticker-r0844cd7638e642adabc1a19b0bbbf715_0ugmc_8byvr_80.webp\" \n             alt=\"QR Code\" style=\"max-width: 120px; height: auto;\">\n    </div>\n</div>\n\n",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-04-14 01:10:28.658068",
  "module": "Myinvois Erpgulf",
  "name": "SalesInvoiceNormaleInvoice",
  "page_number": "Hide",
  "print_format_builder": 1,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 },
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": "\n    @page {\n        size: A4 landscape; /* Change from portrait to landscape */\n        margin: 10mm; /* Adjust margins if needed */\n    }\n",
  "custom_format": 1,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "Sales Invoice",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": "[{\"fieldname\": \"print_heading_template\", \"fieldtype\": \"Custom HTML\", \"options\": \"<div class=\\\"print-heading\\\">\\t\\t\\t\\t<h2><div>Sales Invoice</div><br><small class=\\\"sub-heading\\\">{{ _(doc.name) }}</small>\\t\\t\\t\\t</h2></div>\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"customer_name\", \"print_hide\": 0, \"label\": \"Customer Name\"}, {\"fieldname\": \"tax_id\", \"print_hide\": 0, \"label\": \"Tax Id\"}, {\"fieldname\": \"company_tax_id\", \"print_hide\": 0, \"label\": \"Company Tax ID\"}, {\"fieldname\": \"custom_item_classification_code_\", \"print_hide\": 0, \"label\": \"Item Classification Code \"}, {\"fieldname\": \"custom_einvoice\", \"print_hide\": 0, \"label\": \"e-Invoice\"}, {\"fieldname\": \"is_consolidated\", \"print_hide\": 0, \"label\": \"Is Consolidated\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"posting_date\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Date\"}, {\"fieldname\": \"custom_payment_mode\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Payment Mode of invoice\"}, {\"fieldname\": \"due_date\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Payment Due Date\"}, {\"fieldname\": \"custom_zatca_tax_category\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Tax Category\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"items\", \"print_hide\": 0, \"label\": \"Items\", \"visible_columns\": [{\"fieldname\": \"custom_item_classification_code\", \"print_width\": \"25px\", \"print_hide\": 0}, {\"fieldname\": \"description\", \"print_width\": \"200px\", \"print_hide\": 0}, {\"fieldname\": \"qty\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rate\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"discount_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"item_tax_rate\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"net_amount\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"total_qty\", \"print_hide\": 0, \"label\": \"Total Quantity\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"custom_zatca_tax_category\", \"print_hide\": 0, \"align\": \"right\", \"label\": \"Tax Category\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"tax_category\", \"print_hide\": 0, \"label\": \"Tax Category\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"total\", \"print_hide\": 0, \"label\": \"Total\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Taxes and Charges\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"incoterm\", \"print_hide\": 0, \"label\": \"Incoterm\"}, {\"fieldname\": \"named_place\", \"print_hide\": 0, \"label\": \"Named Place\"}, {\"fieldtype\": \"Section Break\", \"label\": \"\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"taxes\", \"print_hide\": 0, \"label\": \"Sales Taxes and Charges\", \"visible_columns\": [{\"fieldname\": \"charge_type\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"row_id\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"account_head\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"description\", \"print_width\": \"300px\", \"print_hide\": 0}, {\"fieldname\": \"included_in_paid_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"cost_center\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rate\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"account_currency\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"tax_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"total\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"tax_amount_after_discount_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"base_tax_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"base_total\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"base_tax_amount_after_discount_amount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"item_wise_tax_detail\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldtype\": \"Section Break\", \"label\": \"Totals\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"grand_total\", \"print_hide\": 0, \"label\": \"Grand Total\"}, {\"fieldname\": \"use_company_roundoff_cost_center\", \"print_hide\": 0, \"label\": \"Use Company default Cost Center for Round off\"}, {\"fieldname\": \"rounded_total\", \"print_hide\": 0, \"label\": \"Rounded Total\"}, {\"fieldname\": \"in_words\", \"print_hide\": 0, \"label\": \"In Words\"}, {\"fieldname\": \"disable_rounded_total\", \"print_hide\": 0, \"label\": \"Disable Rounded Total\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Additional Discount\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"is_cash_or_non_trade_discount\", \"print_hide\": 0, \"label\": \"Is Cash or Non Trade Discount\"}, {\"fieldname\": \"additional_discount_account\", \"print_hide\": 0, \"label\": \"Discount Account\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Pricing Rules\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"pricing_rules\", \"print_hide\": 0, \"label\": \"Pricing Rule Detail\", \"visible_columns\": [{\"fieldname\": \"pricing_rule\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"item_code\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"margin_type\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rate_or_discount\", \"print_width\": \"\", \"print_hide\": 0}, {\"fieldname\": \"rule_applied\", \"print_width\": \"\", \"print_hide\": 0}]}, {\"fieldtype\": \"Section Break\", \"label\": \"Billing Address\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"address_display\", \"print_hide\": 0, \"label\": \"Address\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"contact_display\", \"print_hide\": 0, \"label\": \"Contact\"}, {\"fieldname\": \"contact_mobile\", \"print_hide\": 0, \"label\": \"Mobile No\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Shipping Address\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"dispatch_address\", \"print_hide\": 0, \"label\": \"Dispatch Address\"}, {\"fieldtype\": \"Section Break\", \"label\": \"Terms and Conditions\"}, {\"fieldtype\": \"Column Break\"}, {\"fieldname\": \"terms\", \"print_hide\": 0, \"label\": \"Terms and Conditions Details\"}]",
  "html": "<center>\n    <h3>Sales Invoice</h3>\n    {% if doc.customer_name %}\n        {{ doc.customer_name }}<br>\n    {% endif %}\n    {% if doc.customer_address %}\n        {{ doc.customer_address }}<br>\n    {% endif %}\n    {% if doc.contact_mobile %}\n        {{ doc.contact_mobile }}<br>\n    {% endif %}\n    {% if doc.contact_email %}\n        {{ doc.contact_email }}<br>\n    {% endif %}\n\n</center>\n\n{% set supplier = frappe.get_doc(\"Company\", doc.supplier) %}\n{% set buyer = frappe.get_doc(\"Customer\", doc.customer) %}\n{% set category_map = {'Malaysian': 'E100000000010', 'Non-Malaysian': 'E100000000020'} %}\n{% set buyer_tin = category_map.get(buyer.custom_customer_category, 'MappingError') %}\n\n\n\n<div style=\"display: grid; grid-template-columns: 1fr 1fr; width: 100%;\">\n    <div class=\"text-left\"><strong>Supplier TIN:</strong> {{ supplier.tax_id }}</div>\n    <div class=\"text-right\"><strong>E-Invoice</strong></div>\n\n    <div class=\"text-left\"><strong>Supplier Registration Number:</strong> {{ supplier.custom_company__registrationicpassport_number }}</div>\n    <div class=\"text-right\"><strong>Document Code:</strong> INV{{ doc.name[-4:] or \"N/A\" }}</div>\n\n    <div class=\"text-left\"><strong>Supplier SST ID:</strong> {{ supplier.custom_sst_number }}</div>\n    <div class=\"text-right\"><strong>Unique Identifier No.:</strong> {{ doc.name or \"N/A\" }}</div>\n\n    <div class=\"text-left\"><strong>Supplier MSIC Code:</strong> {{ supplier.custom_msic_code_.split(':')[0] }}</div>\n    <div class=\"text-right\"><strong>Invoice Date & Time:</strong> {{ doc.posting_date }} {{ doc.posting_time or \"\" }}</div>\n</div>\n\n<hr style=\"border: 0; height: 1px; background: #ccc; margin: 10px 0;\">\n\n<div style=\"display: grid; grid-template-columns: 1fr 1fr; width: 100%;\">\n    <div class=\"text-left\"><strong>Buyer TIN:</strong> {{ buyer_tin }}</div> \n    <div class=\"text-right\"><strong>Payment mode: </strong>{{ doc.custom_payment_mode }}</div>\n\n    <div class=\"text-left\"><strong>Buyer Name:</strong> General Public</div>\n    <div class=\"text-right\"><strong>Frequency of billing:</strong> {{ doc.frequency or \"N/A\" }}</div>\n\n    <div class=\"text-left\"><strong>Buyer Identification Number:</strong> NA</div>\n    <div class=\"text-right\"><strong>Billing period.:</strong> {{ doc.billing_period or \"N/A\" }}</div>\n\n    <div class=\"text-left\"><strong>Buyer Address:</strong> NA</div>\n    <div class=\"text-right\"><strong>Invoice currency code:</strong> {{ doc.currency }}</div>\n    \n    <div class=\"text-left\"><strong>Buyer Contact Number (Mobile):</strong> NA</div>\n    <div class=\"text-left\"><strong>Buyer Email:</strong> NA</div>\n    <div class=\"text-left\"><strong>Buyer SST Registration ID:</strong> NA</div>\n</div>\n\n\n\n<table class=\"table table-bordered\">\n\t<thead style=\"background-color: black; color: white;\">\n\t\t<tr>\n\t\t\t<th class=\"text-center\"><strong>Classification</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Description</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Quantity</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Unit Price</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Amount</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Disc</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Amount</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Total Product / Service Price (incl. tax)</strong></th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t{% for item in doc.items %}\n\t\t<tr>\n\t\t\t<td>004</td>\n\t\t\t<td>{{ item.description or \"\" }}</td>  <!-- consolidate all the invoice here, it should be a running number ABC123 - ABC567, ABC569 - ABC575-->\n\t\t\t<td class=\"text-right\">1</td>\n\t\t\t<td class=\"text-right\">{{ item.rate }}</td>\n\t\t\t<td class=\"text-right\">{{ item.amount }}</td>\n\t\t\t<td class=\"text-right\">{{ item.discount_amount or 0 }}</td>  \n\t\t\t<td class=\"text-right\">{{ item.item_tax_rate or 0 }}</td>\n\t\t\t<td class=\"text-right\">\n\t\t\t\t{{ (item.amount|float - (item.discount_amount|float or 0)) + (item.item_tax_rate|float or 0) }}\n\t\t\t</td>\n\t\t</tr>\n\t\t{% endfor %}\n\t\t\t<!-- Subtotal, Tax, and Grand Total -->\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Subtotal</strong></td>\n\t\t\t<td class=\"text-right\">{{ doc.total }}</td>  <!-- Assuming doc.total exists -->\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.total_taxes_and_charges or 0 }}</td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Total excluding tax</strong></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total - doc.total_taxes_and_charges or 0 }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Tax amount</strong></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.total_taxes_and_charges or 0 }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Total including tax</strong></td>\n\t\t\t<td></td></td> \n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total }}</td>\n\t\t</tr>\n\t\t<tr style=\"background-color: #f2f2f2; font-weight: bold;\">\n\t\t\t<td colspan=\"4\" class=\"text-right\"><strong>Paid by - {{ doc.custom_payment_mode }}</strong></td>\n\t\t\t<td></td></td> \n\t\t\t<td></td>\n\t\t\t<td></td>\n\t\t\t<td class=\"text-right\">{{ doc.grand_total }}</td>\n\t\t</tr>\n\t\t\n\t</tbody>\n</table>\n\n\n<table class=\"table table-bordered\" style=\"width:60%;\">\n\t<thead style=\"background-color: black; color: white;\">\n\t\t<tr>\n\t\t\t<th class=\"text-center\"><strong>Total Product / Service Price</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Type</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Rate</strong></th>\n\t\t\t<th class=\"text-center\"><strong>Tax Amount</strong></th>\n\t\t</tr>\n\t</thead>\n\t<tbody>\n\t\t{% for item in doc.items %}\n\t\t<tr>\n\t\t    <!-- Total Price after Discount -->\n\t\t    <td class=\"text-right\">\n\t\t        {{ (item.amount|float - (item.discount_amount|float or 0)) }}\n\t\t    </td>\n\t\t    \n\t\t    <!-- Tax Type (Fetch from item.tax_code or use default text) -->\n\t\t    <td class=\"text-right\">{{ item.tax_code or \"N/A\" }}</td> \n\t\t    \n\t\t    <!-- Tax Rate (Assuming item.item_tax_rate is already in percentage) -->\n\t\t    <td class=\"text-right\">{{ item.item_tax_rate or 0 }}%</td> \n\n\t\t    <!-- Tax Amount Calculation -->\n\t\t    <td class=\"text-right\">\n\t\t        {{ ((item.amount|float - (item.discount_amount|float or 0)) * (item.item_tax_rate|float or 0) / 100) }}\n\t\t    </td>\n\t\t</tr>\n\t\t{% endfor %}\n\t\t\n\t</tbody>\n</table>\n\n{% set now = frappe.utils.now_datetime() %}\n<div style=\"display: grid; grid-template-columns: 1fr 1fr; width: 100%; align-items: start;\">\n    <!-- Left Column -->\n    <div>\n        <div class=\"text-left\"><strong>Digital Signature:</strong></div> \n        <div class=\"text-left\">{{ doc.digital_signature or \"N/A\" }}</div> \n        \n        <!-- Is this also current date and time? or when the item was submitted? -->\n        <div class=\"text-left\"><strong>Date and Time of Validation:</strong> {{ doc.validation_time or \"N/A\" }}</div> \n        <div class=\"text-left\" style=\"color: red;\">current or doc's validation time? {{ now.strftime(\"%d/%m/%Y %H:%M:%S\") }}</div> \n        \n        <div class=\"text-left\">This document is a visual presentation of the e-Invoice</div>\n    </div>\n\n    <!-- Right Column (QR Code) -->\n    <div class=\"text-right\">\n        <img src=\"https://rlv.zcache.com/customizable_qr_code_square_sticker-r0844cd7638e642adabc1a19b0bbbf715_0ugmc_8byvr_80.webp\" \n             alt=\"QR Code\" style=\"max-width: 120px; height: auto;\">\n    </div>\n</div>\n\nDEBUG:\n<pre>\n    {{ buyer.as_dict() | pprint }}\n</pre>\n",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-04-14 01:10:17.544970",
  "module": "Myinvois Erpgulf",
  "name": "SalesInvoiceConsolidated",
  "page_number": "Hide",
  "print_format_builder": 1,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 },
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": ".report-container {\r\n    page-break-before:auto;\r\n    border-style: hidden;\r\n    border-collapse: collapse;\r\n\r\n  \r\n}\r\n.report-header {\r\n  display:table-header-group;\r\n  font-size:8px;\r\n  border-style:hidden;\r\n   border-collapse: collapse;\r\n   padding:0px;\r\n  \r\n}\r\n\r\n.ksa-invoice-table{\r\n    border-collapse: collapse;\r\n    position: relative;\r\n    margin-top:-5 px;\r\n  \r\n    \r\n    \r\n}\r\n.content0\r\n{\r\n    font-size:60px;\r\n    color: white;\r\n    padding:0px;\r\n    border-collapse: collapse;\r\n    display: table;\r\n    padding-top:1cm;\r\n    \r\n\r\n}\r\n/*@page {*/\r\n/*   margin-top: 6cm; */\r\n/*   margin-bottom: 1.7cm;*/\r\n/*}*/\r\n.box{\r\nwidth: 255px;\r\nheight: 115.5px;\r\nborder: 1px solid black;\r\n}\r\n\r\n@media print {\r\n  .ksa-invoice-table {\r\nposition:relative;\r\n}\r\n .footer {\r\n\r\n    position: fixed;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    background-color: #f8f8f8; /* Adjust as needed */\r\n    text-align: center;\r\n    padding: 10px;\r\n  }\r\n\r\n \r\n  \r\n\r\n\r\n}\r\n  \r\n\r\n.ksa-invoice-table-two-columns\r\n{\r\n    margin-top:4cm;\r\n      \r\n}\r\n.letter-head \r\n{\r\n    page-break-before:always;\r\n    \r\n}\r\n.report-footer {\r\n  display:table-footer-group;\r\n  font-size:8px;\r\n  border-style:hidden;\r\n   border-collapse: collapse;\r\n   padding:0px;\r\n}\r\n\r\n/*.box1{\r\n\r\n    margin-top:5cm;\r\n    bottom:0;\r\nposition:static;\r\n\r\n  \r\n}  */\r\n}\r\n\r\n",
  "custom_format": 1,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "Sales Invoice",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": null,
  "html": "{% macro above_items(current_page, total_pages) %}\r\n<table class=\"report-container\" style=\"width:100%;\">\r\n<thead class=\"report-header\">\r\n<tr>\r\n    {% set company = frappe.get_doc(\"Company\", doc.company) %}\r\n\r\n    {# --- Customer Address --- #}\r\n    {% set customer_address = None %}\r\n    {% if doc.customer_address %}\r\n        {% set customer_address = frappe.get_doc(\"Address\", doc.customer_address) %}\r\n    {% else %}\r\n        {% set customer_doc = frappe.get_doc(\"Customer\", doc.customer) %}\r\n        {% if customer_doc.customer_primary_address %}\r\n            {% set customer_address = frappe.get_doc(\"Address\", customer_doc.customer_primary_address) %}\r\n        {% endif %}\r\n    {% endif %}\r\n\r\n    {# --- Company Address using frappe.get_list --- #}\r\n    {% set company_address = None %}\r\n    {% set address_list = frappe.get_list(\r\n        \"Address\",\r\n        filters={\"is_your_company_address\": \"1\"},\r\n        fields=[\r\n            \"address_line1\",\r\n            \"address_line2\",\r\n            \"city\",\r\n            \"pincode\",\r\n            \"state\",\r\n            \"custom_state_code\",\r\n            \"country\",\r\n            \"phone\",\r\n            \"email_id\",\r\n        ],\r\n        order_by=\"creation asc\"\r\n    ) %}\r\n    {% if address_list and address_list|length > 0 %}\r\n        {% set company_address = address_list[0] %}\r\n    {% endif %}\r\n\r\n    {# --- TIN Fields --- #}\r\n    {% set company_tin = frappe.db.get_value('Company', doc.company, 'custom_company_tin_number') or '' %}\r\n    {% set customer_tin = frappe.db.get_value('Customer', doc.customer, 'custom_customer_tin_number') or '' %}\r\n\r\n    {# --- QR Code --- #}\r\n    {% set qr_url = frappe.db.get_value('File', {'attached_to_name': doc.name, 'attached_to_field': 'custom_einvoice_qr'}, 'file_url') %}\r\n\r\n    <table class=\"ksa-invoice-table two-columns\" style=\"width:100%; border-collapse:collapse;\">\r\n        <tbody>\r\n            <tr>\r\n                <td colspan=\"7\"><b>Buyer</b></td>\r\n                <td colspan=\"7\"><b>Seller</b></td>\r\n                <td colspan=\"3\" rowspan=\"5\" style=\"text-align:center; vertical-align:middle;\">\r\n                    {% if qr_url %}\r\n                        <img src=\"{{ qr_url }}\" style=\"width:130px;height:130px;\">\r\n                    {% endif %}\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"7\">{{ doc.customer_name }}</td>\r\n                <td colspan=\"7\">{{ doc.company }}</td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"7\"><b>TIN:</b> {{ customer_tin }}</td>\r\n                <td colspan=\"7\"><b>TIN:</b> {{ company_tin }}</td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"7\" style=\"font-size:10px;\">\r\n                    {% if customer_address %}\r\n                        {{ customer_address.address_line1 or '' }}<br>\r\n                        {{ customer_address.address_line2 or '' }}<br>\r\n                        {{ customer_address.city or '' }}, {{ customer_address.state or '' }}<br>\r\n                        {{ customer_address.country or '' }}, {{ customer_address.pincode or '' }}\r\n                    {% endif %}\r\n                </td>\r\n                <td colspan=\"7\" style=\"font-size:10px;\">\r\n                    {% if company_address %}\r\n                        {{ company_address.address_line1 or '' }}<br>\r\n                        {{ company_address.address_line2 or '' }}<br>\r\n                        {{ company_address.city or '' }}, {{ company_address.state or '' }}<br>\r\n                        {{ company_address.country or '' }}, {{ company_address.pincode or '' }}\r\n                    {% endif %}\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"7\"><b>Invoice No:</b> {{ doc.name }}</td>\r\n                <td colspan=\"7\"><b>Date:</b> {{ frappe.format(doc.posting_date, {'fieldtype':'Date'}) }}</td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n</tr>\r\n</thead>\r\n</table>\r\n{% endmacro %}\r\n\r\n{% set current_page = namespace(value=1) %}\r\n{% set total_pages = namespace(value=1) %}\r\n{% set total_items = namespace(value=doc.items | length) %}\r\n{% set total_pages.value = (total_items.value / 22) | round(0,'ceil') | int %}\r\n\r\n{{ above_items(current_page.value, total_pages.value) }}\r\n\r\n{# --- Items Table --- #}\r\n<table class=\"ksa-invoice-table\" style=\"width:100%; border-collapse:collapse;\">\r\n<thead>\r\n<tr>\r\n    <th><b>No.</b></th>\r\n    <th><b>Description</b></th>\r\n    <th><b>Quantity</b></th>\r\n    <th><b>Unit Price</b></th>\r\n    <th><b>Taxable Amount</b></th>\r\n    <th><b>Tax Rate (%)</b></th>\r\n    <th><b>Tax Amount</b></th>\r\n    <th><b>Subtotal (Inc. VAT)</b></th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n{% set current_row = namespace(value=1) %}\r\n{% for item in doc.items %}\r\n    {% if current_row.value > 22 %}\r\n        {% set current_page.value = current_page.value + 1 %}\r\n        {{ above_items(current_page.value, total_pages.value) }}\r\n        {% set current_row.value = 1 %}\r\n    {% endif %}\r\n    <tr>\r\n        <td>{{ item.idx }}</td>\r\n        <td>{{ item.item_code }} {{ item.item_name }}</td>\r\n        <td style=\"text-align:center;\">{{ item.qty }}</td>\r\n        <td style=\"text-align:right;\">{{ item.get_formatted(\"rate\") }}</td>\r\n        <td style=\"text-align:right;\">{{ item.get_formatted(\"amount\") }}</td>\r\n        <td style=\"text-align:center;\">\r\n            {% if item.tax_rate %}\r\n                {{ item.tax_rate }} %\r\n            {% else %}\r\n                0 %\r\n            {% endif %}\r\n        </td>\r\n        \r\n        <td style=\"text-align:right;\">\r\n            {% if item.tax_amount %}\r\n                {{ item.get_formatted(\"tax_amount\") }}\r\n            {% else %}\r\n                0.00\r\n            {% endif %}\r\n        </td>\r\n        \r\n        <td style=\"text-align:right;\">\r\n            {% set subtotal = (item.amount or 0) + (item.tax_amount or 0) %}\r\n            {{ \"{:,.2f}\".format(subtotal) }}\r\n        </td>\r\n    </tr>\r\n    {% set current_row.value = current_row.value + 1 %}\r\n{% endfor %}\r\n</tbody>\r\n</table>\r\n\r\n{# --- Totals Table --- #}\r\n<table style=\"width:100%; border-collapse:collapse; margin-top:10px;\">\r\n<tr>\r\n    <td><b>Total (Excl. VAT)</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"total\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>Discount</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"discount_amount\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>Total Taxable Amount</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"net_total\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>Total Tax (VAT)</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"total_taxes_and_charges\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>Grand Total</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"grand_total\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>LHDN Status</b></td>\r\n    <td>{{ doc.custom_lhdn_status or '' }}</td>\r\n</tr>\r\n</table>\r\n\r\n<style>\r\ntable, th, td {\r\n    border: 1px solid black;\r\n    border-collapse: collapse;\r\n    font-size:10px;\r\n    font-family:Arial;\r\n    line-height:10px;\r\n}\r\nth, td {\r\n    padding: 3px;\r\n}\r\n</style>\r\n",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-10-27 17:24:19.615797",
  "module": "Myinvois Erpgulf",
  "name": "Malaysia SI format",
  "page_number": "Hide",
  "print_format_builder": 0,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 },
 {
  "absolute_value": 0,
  "align_labels_right": 0,
  "css": ".report-container {\r\n    page-break-before:auto;\r\n    border-style: hidden;\r\n    border-collapse: collapse;\r\n\r\n  \r\n}\r\n.report-header {\r\n  display:table-header-group;\r\n  font-size:8px;\r\n  border-style:hidden;\r\n   border-collapse: collapse;\r\n   padding:0px;\r\n  \r\n}\r\n\r\n.ksa-invoice-table{\r\n    border-collapse: collapse;\r\n    position: relative;\r\n    margin-top:-5 px;\r\n  \r\n    \r\n    \r\n}\r\n.content0\r\n{\r\n    font-size:60px;\r\n    color: white;\r\n    padding:0px;\r\n    border-collapse: collapse;\r\n    display: table;\r\n    padding-top:1cm;\r\n    \r\n\r\n}\r\n/*@page {*/\r\n/*   margin-top: 6cm; */\r\n/*   margin-bottom: 1.7cm;*/\r\n/*}*/\r\n.box{\r\nwidth: 255px;\r\nheight: 115.5px;\r\nborder: 1px solid black;\r\n}\r\n\r\n@media print {\r\n  .ksa-invoice-table {\r\nposition:relative;\r\n}\r\n .footer {\r\n\r\n    position: fixed;\r\n    bottom: 0;\r\n    left: 0;\r\n    width: 100%;\r\n    background-color: #f8f8f8; /* Adjust as needed */\r\n    text-align: center;\r\n    padding: 10px;\r\n  }\r\n\r\n \r\n  \r\n\r\n\r\n}\r\n  \r\n\r\n.ksa-invoice-table-two-columns\r\n{\r\n    margin-top:4cm;\r\n      \r\n}\r\n.letter-head \r\n{\r\n    page-break-before:always;\r\n    \r\n}\r\n.report-footer {\r\n  display:table-footer-group;\r\n  font-size:8px;\r\n  border-style:hidden;\r\n   border-collapse: collapse;\r\n   padding:0px;\r\n}\r\n\r\n/*.box1{\r\n\r\n    margin-top:5cm;\r\n    bottom:0;\r\nposition:static;\r\n\r\n  \r\n}  */\r\n}\r\n\r\n",
  "custom_format": 1,
  "default_print_language": "en",
  "disabled": 0,
  "doc_type": "Purchase Invoice",
  "docstatus": 0,
  "doctype": "Print Format",
  "font": null,
  "font_size": 14,
  "format_data": null,
  "html": "{% macro above_items(current_page, total_pages) %}\r\n<table class=\"report-container\" style=\"width:100%;\">\r\n<thead class=\"report-header\">\r\n<tr>\r\n    {% set company = frappe.get_doc(\"Company\", doc.company) %}\r\n\r\n    {# --- Supplier Address --- #}\r\n    {% set supplier_address = None %}\r\n    {% if doc.supplier_address %}\r\n        {% set supplier_address = frappe.get_doc(\"Address\", doc.supplier_address) %}\r\n    {% else %}\r\n        {% set supplier_doc = frappe.get_doc(\"Supplier\", doc.supplier) %}\r\n        {% if supplier_doc.supplier_primary_address %}\r\n            {% set supplier_address = frappe.get_doc(\"Address\", supplier_doc.supplier_primary_address) %}\r\n        {% endif %}\r\n    {% endif %}\r\n\r\n    {# --- Company Address --- #}\r\n    {% set company_address = None %}\r\n    {% set address_list = frappe.get_list(\r\n        \"Address\",\r\n        filters={\"is_your_company_address\": \"1\"},\r\n        fields=[\r\n            \"address_line1\",\r\n            \"address_line2\",\r\n            \"city\",\r\n            \"pincode\",\r\n            \"state\",\r\n            \"custom_state_code\",\r\n            \"country\",\r\n            \"phone\",\r\n            \"email_id\",\r\n        ],\r\n        order_by=\"creation asc\"\r\n    ) %}\r\n    {% if address_list and address_list|length > 0 %}\r\n        {% set company_address = address_list[0] %}\r\n    {% endif %}\r\n\r\n    {# --- TIN Fields --- #}\r\n    {% set company_tin = frappe.db.get_value('Company', doc.company, 'custom_company_tin_number') or '' %}\r\n    {% set supplier_tin = frappe.db.get_value('Supplier', doc.supplier, 'custom_customer_tin_number') or '' %}\r\n\r\n    {# --- QR Code --- #}\r\n    {% set qr_url = frappe.db.get_value('File', {'attached_to_name': doc.name, 'attached_to_field': 'custom_einvoice_qr'}, 'file_url') %}\r\n\r\n    <table class=\"ksa-invoice-table two-columns\" style=\"width:100%; border-collapse:collapse;\">\r\n        <tbody>\r\n            <tr>\r\n                <td colspan=\"7\"><b>Supplier</b></td>\r\n                <td colspan=\"7\"><b>Company</b></td>\r\n                <td colspan=\"3\" rowspan=\"5\" style=\"text-align:center; vertical-align:middle;\">\r\n                    {% if qr_url %}\r\n                        <img src=\"{{ qr_url }}\" style=\"width:130px;height:130px;\">\r\n                    {% endif %}\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"7\">{{ doc.supplier_name }}</td>\r\n                <td colspan=\"7\">{{ doc.company }}</td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"7\"><b>TIN:</b> {{ supplier_tin }}</td>\r\n                <td colspan=\"7\"><b>TIN:</b> {{ company_tin }}</td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"7\" style=\"font-size:10px;\">\r\n                    {% if supplier_address %}\r\n                        {{ supplier_address.address_line1 or '' }}<br>\r\n                        {{ supplier_address.address_line2 or '' }}<br>\r\n                        {{ supplier_address.city or '' }}, {{ supplier_address.state or '' }}<br>\r\n                        {{ supplier_address.country or '' }}, {{ supplier_address.pincode or '' }}\r\n                    {% endif %}\r\n                </td>\r\n                <td colspan=\"7\" style=\"font-size:10px;\">\r\n                    {% if company_address %}\r\n                        {{ company_address.address_line1 or '' }}<br>\r\n                        {{ company_address.address_line2 or '' }}<br>\r\n                        {{ company_address.city or '' }}, {{ company_address.state or '' }}<br>\r\n                        {{ company_address.country or '' }}, {{ company_address.pincode or '' }}\r\n                    {% endif %}\r\n                </td>\r\n            </tr>\r\n            <tr>\r\n                <td colspan=\"7\"><b>Invoice No:</b> {{ doc.name }}</td>\r\n                <td colspan=\"7\"><b>Date:</b> {{ frappe.format(doc.posting_date, {'fieldtype':'Date'}) }}</td>\r\n            </tr>\r\n        </tbody>\r\n    </table>\r\n</tr>\r\n</thead>\r\n</table>\r\n{% endmacro %}\r\n\r\n{% set current_page = namespace(value=1) %}\r\n{% set total_pages = namespace(value=1) %}\r\n{% set total_items = namespace(value=doc.items | length) %}\r\n{% set total_pages.value = (total_items.value / 22) | round(0,'ceil') | int %}\r\n\r\n{{ above_items(current_page.value, total_pages.value) }}\r\n\r\n{# --- Items Table --- #}\r\n<table class=\"ksa-invoice-table\" style=\"width:100%; border-collapse:collapse;\">\r\n<thead>\r\n<tr>\r\n    <th><b>No.</b></th>\r\n    <th><b>Description</b></th>\r\n    <th><b>Quantity</b></th>\r\n    <th><b>Unit Price</b></th>\r\n    <th><b>Taxable Amount</b></th>\r\n    <th><b>Tax Rate (%)</b></th>\r\n    <th><b>Tax Amount</b></th>\r\n    <th><b>Subtotal (Inc. VAT)</b></th>\r\n</tr>\r\n</thead>\r\n<tbody>\r\n{% set current_row = namespace(value=1) %}\r\n{% for item in doc.items %}\r\n    {% if current_row.value > 22 %}\r\n        {% set current_page.value = current_page.value + 1 %}\r\n        {{ above_items(current_page.value, total_pages.value) }}\r\n        {% set current_row.value = 1 %}\r\n    {% endif %}\r\n    <tr>\r\n        <td>{{ item.idx }}</td>\r\n        <td>{{ item.item_code }} {{ item.item_name }}</td>\r\n        <td style=\"text-align:center;\">{{ item.qty }}</td>\r\n        <td style=\"text-align:right;\">{{ item.get_formatted(\"rate\") }}</td>\r\n        <td style=\"text-align:right;\">{{ item.get_formatted(\"amount\") }}</td>\r\n        <td style=\"text-align:center;\">\r\n            {% if item.tax_rate %}\r\n                {{ item.tax_rate }} %\r\n            {% else %}\r\n                0 %\r\n            {% endif %}\r\n        </td>\r\n        \r\n        <td style=\"text-align:right;\">\r\n            {% if item.tax_amount %}\r\n                {{ item.get_formatted(\"tax_amount\") }}\r\n            {% else %}\r\n                0.00\r\n            {% endif %}\r\n        </td>\r\n        \r\n        <td style=\"text-align:right;\">\r\n            {% set subtotal = (item.amount or 0) + (item.tax_amount or 0) %}\r\n            {{ \"{:,.2f}\".format(subtotal) }}\r\n        </td>\r\n    </tr>\r\n    {% set current_row.value = current_row.value + 1 %}\r\n{% endfor %}\r\n</tbody>\r\n</table>\r\n\r\n{# --- Totals Table --- #}\r\n<table style=\"width:100%; border-collapse:collapse; margin-top:10px;\">\r\n<tr>\r\n    <td><b>Total (Excl. VAT)</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"total\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>Discount</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"discount_amount\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>Total Taxable Amount</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"net_total\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>Total Tax (VAT)</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"total_taxes_and_charges\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>Grand Total</b></td>\r\n    <td style=\"text-align:right;\">{{ doc.get_formatted(\"grand_total\") }}</td>\r\n</tr>\r\n<tr>\r\n    <td><b>LHDN Status</b></td>\r\n    <td>{{ doc.custom_lhdn_status or '' }}</td>\r\n</tr>\r\n</table>\r\n\r\n<style>\r\ntable, th, td {\r\n    border: 1px solid black;\r\n    border-collapse: collapse;\r\n    font-size:10px;\r\n    font-family:Arial;\r\n    line-height:10px;\r\n}\r\nth, td {\r\n    padding: 3px;\r\n}\r\n</style>\r\n",
  "line_breaks": 0,
  "margin_bottom": 15.0,
  "margin_left": 15.0,
  "margin_right": 15.0,
  "margin_top": 15.0,
  "modified": "2025-10-27 17:29:28.868892",
  "module": "Myinvois Erpgulf",
  "name": "Malaysia PI Format",
  "page_number": "Hide",
  "print_format_builder": 0,
  "print_format_builder_beta": 0,
  "print_format_type": "Jinja",
  "raw_commands": null,
  "raw_printing": 0,
  "show_section_headings": 0,
  "standard": "No"
 }
]